# 講義スライド自動生成ツール v2.0

テキストから講義スライドを自動生成するStreamlitアプリケーションです。

## 🎯 新しいワークフロー

```
テキスト入力
    ↓
アウトライン生成（txt、人間が読みやすい形式）
    ↓
【人間が確認・修正】← ここがポイント！
    ↓
LLMでtxtをJSONに変換（フォーマットのズレを自動修正）
    ↓
JSONからPowerPointスライド生成
```

## 📦 ファイル構成

```
.
├── app.py                      # Streamlitメインアプリ
├── generate_outline.py         # テキスト → アウトライン生成
├── outline_to_json.py          # アウトライン → JSON変換
├── generate_slides.py          # JSON → PowerPoint生成
├── requirements.txt            # 必要なライブラリ
└── README.md                   # このファイル
```

## 🚀 セットアップ

### 1. 必要なライブラリをインストール

```bash
pip install -r requirements.txt
```

### 2. APIキーの準備

Anthropic APIキーを取得してください。
https://console.anthropic.com/

### 3. アプリケーションを起動

```bash
streamlit run app.py
```

ブラウザが自動的に開きます（通常 http://localhost:8501）

## 📖 使い方

### Step 1: アウトライン生成

1. サイドバーでAPIキーを入力
2. 講義内容を自由にテキストで入力
3. 生成方法を選択:
   - **「アウトライン生成」**: 標準的な枚数（3-5アジェンダ、各1-3スライド）
   - **「もっと詳しく」**: より詳細な内容（4-7アジェンダ、各2-5スライド） ← NEW!
4. 生成されたアウトラインを確認・修正
5. 「このアウトラインで確定」をクリック

### Step 2: スライド生成

1. サイドバーでPowerPointテンプレートをアップロード
2. アウトラインの入力方法を選択:
   - Step 1から引き継ぐ
   - テキストファイルをアップロード
   - 直接入力
3. 「スライド生成」ボタンをクリック
4. 生成されたPowerPointファイルをダウンロード

## 📝 アウトライン形式

```
タイトル: 講義のタイトル

アジェンダ:
1. アジェンダ1
2. アジェンダ2
3. アジェンダ3

---

## 1. アジェンダ1

### スライド1
- 箇条書き項目1
- 箇条書き項目2
  - サブ項目

### スライド2
- 箇条書き項目1
- 箇条書き項目2

---

## 2. アジェンダ2

### スライド1
- 箇条書き項目1
```

この形式なら人間が読みやすく、修正もしやすいです！

## 🎨 テンプレートの要件

PowerPointテンプレートには以下のレイアウトが必要です：

- **main_template** (index 0): メインスライド
  - プレースホルダー idx=13: 左側（見出し）
  - プレースホルダー idx=14: 右側（本文）

- **start** (index 1): 開始スライド
  - プレースホルダー idx=13: タイトル

- **end** (index 2): 終了スライド

## 🔧 トラブルシューティング

### APIキーエラー
- サイドバーでAPIキーを正しく入力してください
- または環境変数 `ANTHROPIC_API_KEY` を設定してください

### テンプレートエラー
- テンプレートファイルが正しい構造か確認してください
- `generate_slides.py` で期待するレイアウトと一致しているか確認

### アウトライン形式エラー
- LLMが自動で修正しますが、極端に形式が違うとエラーになる可能性があります
- 基本的な構造（タイトル、アジェンダ、## 見出し）は維持してください

## 🌐 デプロイ（オプション）

### Streamlit Cloudにデプロイ

1. GitHubリポジトリにコードをプッシュ
2. https://streamlit.io/cloud にアクセス
3. 「New app」から作成
4. Secretsに `ANTHROPIC_API_KEY` を設定

### その他のプラットフォーム

- Heroku
- Google Cloud Run
- AWS App Runner

いずれの場合も、環境変数に `ANTHROPIC_API_KEY` を設定してください。

## 💡 Tips

- アウトラインは何度でも修正可能です
- **「もっと詳しく」ボタン**: より詳細なスライドを生成したい場合に使用（結果的に枚数が増えます）
- Step 1とStep 2は独立しているので、別々に使えます
- JSONファイルもダウンロードできるので、後で再利用できます
- 詳細版で生成後も、アウトラインを編集して調整できます

## 📄 ライセンス

MIT License
